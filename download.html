<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Secure Access</title>

<style>
:root{
  --bg:#f2f2f7;--card:#fff;--text:#0f172a;
  --muted:#6b7280;--primary:#007aff;
  --danger:#ff3b30;--soft:#f4f4f5;
}
@media(prefers-color-scheme:dark){
  :root{
    --bg:#0b0f1a;--card:#111827;--text:#e5e7eb;
    --muted:#9ca3af;--primary:#0a84ff;
    --danger:#ff453a;--soft:#1f2937;
  }
}
*{box-sizing:border-box}
body{
  margin:0;font-family:-apple-system,BlinkMacSystemFont,"SF Pro Text",system-ui;
  background:var(--bg);color:var(--text);
}
.container{max-width:420px;margin:auto;padding:20px}
.card{
  background:var(--card);border-radius:28px;padding:22px;
  box-shadow:0 18px 40px rgba(0,0,0,.12);
}
.hidden{display:none}
input,button{
  width:100%;padding:14px;border-radius:16px;border:none;font-size:15px
}
input{background:var(--soft);color:var(--text);margin-top:10px}
button{margin-top:14px;background:var(--primary);color:#fff;font-weight:600}
button.secondary{background:var(--soft);color:var(--text)}
.info{font-size:12px;color:var(--muted);margin-top:8px}
.error{font-size:12px;color:var(--danger);margin-top:6px}
.box{background:var(--soft);padding:12px;border-radius:16px;font-size:13px}
.section{margin-top:20px}
</style>
</head>

<body>
<div class="container">

<!-- LOGIN -->
<div id="loginBox" class="card">
  <input id="sitePass" type="password" placeholder="Website password">
  <button onclick="loginSite()">Login</button>
  <div class="info">
    Format: RS@DDMMYYYY<br>
    Today: <b id="todayPass"></b>
  </div>
  <div id="siteErr" class="error"></div>
</div>

<!-- DASHBOARD -->
<div id="contentBox" class="card hidden">
  <div class="box" id="sessionTimer"></div>

  <div class="section">
    <button class="secondary" onclick="toggleGuide()">Instructions</button>
    <div id="guideBox" class="box hidden">
      Turn OFF Private DNS<br>
      Update Chrome<br>
      Use Chrome / Opera Mini<br>
      Extra page → BACK once<br>
      Valid for 24 hours only
    </div>
  </div>

  <div class="section">
    <button onclick="window.open('https://rarestudy.site','_blank')">
      Open Website
    </button>
  </div>

  <div class="section">
    <input id="apkPass" type="password" placeholder="APK password">
    <button onclick="unlockApk()">Unlock APK</button>
    <div id="apkErr" class="error"></div>
    <a id="apkLink" class="hidden"
      href="https://drive.google.com/uc?export=download&id=1dTC01CLUktCk2BDQN1bfEglRUuvpM8sH">
      <button class="secondary">Download APK</button>
    </a>
  </div>

  <div class="section">
    <div class="box" id="historyBox"></div>
  </div>
</div>

<!-- ADMIN PANEL (HIDDEN) -->
<div id="adminPanel" class="card hidden">
  <input id="adminPass" type="password" placeholder="Admin password">
  <button onclick="adminLogin()">Unlock Admin</button>
  <div id="adminErr" class="error"></div>

  <div id="adminActions" class="hidden">
    <input id="tempPass" placeholder="Set temporary password">
    <button onclick="setTempPassword()">Set Temp Password (24h)</button>
    <button class="secondary" onclick="clearHistory()">Clear History</button>
    <button class="secondary" onclick="forceLogout()">Force Logout</button>
  </div>
</div>

</div>

<script>
const SESSION=24*60*60*1000;
const HISTORY_DAYS=7;

function today(){
  const d=new Date();
  return String(d.getDate()).padStart(2,'0')+
         String(d.getMonth()+1).padStart(2,'0')+
         d.getFullYear();
}

/* PASSWORD LOGIC */
function getSitePassword(){
  const o=JSON.parse(localStorage.getItem("siteOverride")||"null");
  if(o && Date.now()<o.expires) return o.password;
  return "RS@"+today();
}
const apkPassword="APK@"+today();
todayPass.innerText=getSitePassword();

/* LOGIN */
function loginSite(){
  if(sitePass.value!==getSitePassword()){
    siteErr.innerText="Wrong password";return;
  }
  localStorage.setItem("loginTime",Date.now());
  addHistory("Website Login");
  loginBox.classList.add("hidden");
  contentBox.classList.remove("hidden");
  startSession();
}

/* SESSION */
function startSession(){
  setInterval(()=>{
    const t=localStorage.getItem("loginTime");
    if(!t||Date.now()-t>SESSION){
      localStorage.clear();location.reload();
    }
    const left=SESSION-(Date.now()-t);
    sessionTimer.innerText=`Session expires in ${Math.floor(left/3600000)}h`;
  },1000);
}

/* APK */
function unlockApk(){
  if(apkPass.value!==apkPassword){
    apkErr.innerText="Wrong APK password";return;
  }
  apkLink.classList.remove("hidden");
  addHistory("APK Unlocked");
}

/* HISTORY */
function addHistory(type){
  const now=Date.now(),limit=HISTORY_DAYS*24*60*60*1000;
  let list=JSON.parse(localStorage.getItem("history")||"[]");
  list=list.filter(i=>now-i.time<limit);
  list.unshift({type,time:now});
  localStorage.setItem("history",JSON.stringify(list));
  renderHistory();
}
function renderHistory(){
  const list=JSON.parse(localStorage.getItem("history")||"[]");
  historyBox.innerHTML=list.length
    ? list.map(i=>`• ${i.type} — ${new Date(i.time).toLocaleString()}`).join("<br>")
    : "No recent activity";
}

/* ADMIN */
function adminPassword(){return "ADMIN@"+today();}
function adminLogin(){
  if(adminPass.value!==adminPassword()){
    adminErr.innerText="Access denied";return;
  }
  adminActions.classList.remove("hidden");
}
function setTempPassword(){
  const pass=tempPass.value.trim();
  if(!pass) return alert("Enter password");
  localStorage.setItem("siteOverride",JSON.stringify({
    password:pass,
    expires:Date.now()+SESSION
  }));
  alert("Temporary password active for 24 hours");
}
function clearHistory(){
  localStorage.removeItem("history");renderHistory();
}
function forceLogout(){
  localStorage.removeItem("loginTime");location.reload();
}

/* UI */
function toggleGuide(){guideBox.classList.toggle("hidden");}

/* SECRET ADMIN OPEN */
document.addEventListener("keydown",e=>{
  if(e.ctrlKey&&e.shiftKey&&e.key==="A"){
    adminPanel.classList.toggle("hidden");
  }
});

/* RESUME */
window.onload=()=>{
  renderHistory();
  const t=localStorage.getItem("loginTime");
  if(t&&Date.now()-t<SESSION){
    loginBox.classList.add("hidden");
    contentBox.classList.remove("hidden");
    startSession();
  }
};
</script>
</body>
      </html>
